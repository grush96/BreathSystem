<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Cover - Free Bulma template</title>
    <link rel="shortcut icon" href="../images/fav_icon.png" type="image/x-icon">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/bulma@0.9.0/css/bulma.min.css" />
    <link rel="stylesheet" href="main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@700&family=Montserrat:wght@500&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/0b69a58e13.js" crossorigin="anonymous"></script>
    <style>
        label {
            text-shadow: 
                -2px -2px 10px #000, 
                2px -2px 10px #000, 
                -2px 2px 10px #000, 
                2px 2px 10px #000;
        }
    </style>
</head>

<body>
    <section class="hero is-fullheight is-default is-bold is-landing">
        <div class="hero-head">
            <nav class="navbar">
                <div class="container">
                    <div class="navbar-brand">
                        <a class="navbar-item">
                            <p class="title">Breath System</p>
                        </a>
                        <!-- <span class="navbar-burger burger" data-target="navbarMenu">
                            <span></span>
                            <span></span>
                            <span></span>
                        </span> -->
                    </div>
                    <div id="navbarMenu" class="navbar-menu">
                        <div class="navbar-end">
                            <div class="tabs is-right">
                                <ul>
                                    <!-- <li class="is-active"><a>Home</a></li>
                                    <li><a href="">Examples</a></li>
                                    <li><a href="">Features</a></li>
                                    <li><a href="">Team</a></li>
                                    <li><a href="">Help</a></li> -->
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
            <div class="underline"></div>
        </div>
        <div class="hero-body">
            <div class="container" id="version">
                <div class="dropdown is-right is-hoverable">
                    <div class="dropdown-trigger">
                        <div class="tags has-addons">
                            <span class="tag is-dark">Version</span>
                            <span class="tag is-info">0.1.0</span>
                        </div>
                    </div>
                    <div class="dropdown-menu" id="dropdown-menu4" role="menu">
                      <div class="dropdown-content">
                        <div class="dropdown-item">
                          <p>You can insert <strong>any type of content</strong> within the dropdown menu.</p>
                        </div>
                      </div>
                    </div>
                  </div>
            </div>
            <div class="container has-text-centered">
                <!-- <div>
                    <p class="title" id="slogan">When you need a little more randomness in your life...</p>
                </div> -->
                <!-- <div>
                    <div class="divider">Exemple</div>
                </div> -->
                <div class="columns is-vcentered">
                    <div class="column is-5">
                        <form action="main.html" id="dm-input">
                            <div class="form-control"> 
                                <!-- <h1 type="hidden" class="mb-3 title" name="username" value="DM">DM</h1> -->
                                <input name="username" id="username" type="hidden" value="DM" readonly>
                            </div>
                            <button type="submit" class="button title" id="dm-join">Create Session</button>
                        </form>
                    </div>
                    <!-- <div class="column is-2">
                        <div class="divider is-vertical is-light"><p class="subtitle is-white">OR</p></div>
                    </div> -->
                    <!-- is-offset-1 -->
                    <div class="column is-5"> 
                        <form action="main.html">
                            <div class="form-control subtitle mb-3">
                                <div class="field">
                                    <label for="username">Player Name</label>
                                    <div class="control has-icons-left has-icons-right">
                                        <input class="input" name="username" id="username" type="text" autocomplete="off" placeholder="Enter name..."  required>
                                        <span class="icon is-small is-left">
                                            <i class="fas fa-dragon"></i>
                                        </span>
                                        <span class="icon is-small has-text-danger is-right is-hidden">
                                            <i class="fas fa-exclamation-triangle"></i>
                                        </span>
                                    </div>
                                    <p class="help is-danger is-hidden">Please enter name</p>
                                </div>
                            </div>
                            <div class="form-control subtitle mb-3">
                                <div class="field">
                                    <label for="room">Room Code</label>
                                    <div class="control has-icons-left has-icons-right">
                                        <input class="input" name="room" id="room" type="text"  autocomplete="off" placeholder="Enter room..." required>
                                        <span class="icon is-small is-left">
                                            <i class="fas fa-dungeon"></i>
                                        </span>
                                        <span class="icon is-small has-text-danger is-right is-hidden">
                                            <i class="fas fa-exclamation-triangle"></i>
                                        </span>
                                    </div>
                                    <p class="help is-danger is-hidden">Please enter room</p>
                                </div>
                            </div>
                            <button type="submit" class="button title mt-3" id="player-join">Join Session</button>
                        </form>
                    </div>
                </div>
            </div>
            
        </div>

        <!-- <div class="hero-foot">
            <div class="container">
                <div class="tabs is-centered">
                    <img src="images/Dice/dall-color.svg" height="auto" width="100%" /> -->
                    <!-- <ul>
                        <li><a>And this  is the bottom</a></li>
                    </ul>
                </div>
            </div>
        </div> -->
    </section>
    <!-- <script src="../js/bulma.js"></script> -->
    <script>
        // const room = Math.random().toString(36).substr(2, 5);
        const alphabet = "ABCDEFGHJKLMNPQRSTUVWXYZ";
        var roomCode = "";
        for (let i = 0; i < 4; i++) {
            roomCode += randomLetter();
        }

        const roomNum = document.createElement('div'); 
        roomNum.classList.add('form-control');
        roomNum.innerHTML = `<input type="hidden" name="room" id="room" value="${roomCode}" readonly>`;
        document.getElementById('dm-input').appendChild(roomNum);

        // TODO: also include check for room existence 
        document.getElementById('player-join').addEventListener("click", function(event) {
            const nameField = document.getElementsByClassName('input')[0];
            const roomField = document.getElementsByClassName('input')[1];

            const nameValid = validateField(nameField);
            const roomValid = validateField(roomField);

            if (!nameValid || !roomValid) {
                event.preventDefault();
            }
        });

        document.querySelector('.input#username').addEventListener("focusout", function() {
            const nameField = document.getElementsByClassName('input')[0];
            validateField(nameField);
        });

        document.querySelector('.input#room').addEventListener("focusout", function() {
            const roomField = document.getElementsByClassName('input')[1];
            validateField(roomField);
        });

        function randomLetter() {
            return alphabet[Math.floor(Math.random() * alphabet.length)];
        }

        function validateField(field) {
            let valid = true;
            if (!field.value) {
                valid = false;
                field.classList.add('is-danger');
                field.parentElement.getElementsByClassName('is-right')[0].classList.remove('is-hidden');
                field.parentElement.parentElement.getElementsByClassName('help')[0].classList.remove('is-hidden');
            } else {
                field.classList.remove('is-danger');
                field.parentElement.getElementsByClassName('is-right')[0].classList.add('is-hidden');
                field.parentElement.parentElement.getElementsByClassName('help')[0].classList.add('is-hidden');
            }
            return valid;
        }
    </script>
</body>

</html>